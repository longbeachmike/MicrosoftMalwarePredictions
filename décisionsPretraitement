-- (1) Machine identifier (drop)
select MachineIdentifier, COUNT(*) from DSGP.dbo.train group by MachineIdentifier

-- (2) ProductName (ok) (6 modalit�s)
select ProductName, COUNT(*) as nb from DSGP.dbo.train group by ProductName order by ProductName asc

-- (3)EngineVersion (ok) (70 : regroupement ?)
select EngineVersion, COUNT(*) as nb from DSGP.dbo.train group by EngineVersion order by EngineVersion asc
-- select substring(EngineVersion,1,7) as EngineVersion, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2)  as prop from DSGP.dbo.train group by substring(EngineVersion,1,7) order by prop asc
--  Retenue !
select substring(EngineVersion,1,6) as EngineVersion, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by substring(EngineVersion,1,6) order by prop asc

-- (4) AppVersion (ok) (110 : regroupement ?)
select AppVersion, COUNT(*) as nb from DSGP.dbo.train group by AppVersion order by AppVersion asc
--select substring(AppVersion,1,7) as AppVersion, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2)  as prop from DSGP.dbo.train group by substring(AppVersion,1,7) order by prop asc
-- Retient 
select substring(AppVersion,1,3) as AppVersion, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by substring(AppVersion,1,3) order by prop asc

-- (5) AvSigVersion (ok) (8531 : regroupement ?)
select AvSigVersion, COUNT(*) as nb from DSGP.dbo.train group by AvSigVersion order by AvSigVersion asc
--select substring(AppVersion,1,3), substring(AvSigVersion,1,4) as AvSigVersion, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by substring(AppVersion,1,3), substring(AvSigVersion,1,4) order by prop asc
-- Retient 
select substring(AvSigVersion,1,3) as AvSigVersion, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by substring(AvSigVersion,1,3) order by prop asc


-- (6) isBeta (ok) (binaire)
select isBeta, COUNT(*) as nb from DSGP.dbo.train group by isBeta order by isBeta asc


-- (7) RtpStateBitfield (ok) (7)
select RtpStateBitfield, COUNT(*) as nb from DSGP.dbo.train group by RtpStateBitfield order by RtpStateBitfield asc


-- (8) isSxsPassiveMode (ok) (2)
select isSxsPassiveMode, COUNT(*) as nb from DSGP.dbo.train group by isSxsPassiveMode order by isSxsPassiveMode asc

-- (9) DefaultBrowserIdentifier (beaucoup) (2018) (0)
select DefaultBrowsersIdentifier, COUNT(*) as nb from DSGP.dbo.train group by DefaultBrowsersIdentifier order by DefaultBrowsersIdentifier asc

select DefaultBrowsersIdentifier, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop into #dbi from DSGP.dbo.train group by DefaultBrowsersIdentifier


-- (10) AVProductStatesIdentifier (beaucoup) (28971) (0)
select AVProductStatesIdentifier, COUNT(*) as nb from DSGP.dbo.train group by AVProductStatesIdentifier order by AVProductStatesIdentifier asc
select AVProductStatesIdentifier, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop into #avpsi from DSGP.dbo.train group by AVProductStatesIdentifier
select * from #avpsi

-- (11) AVProductsInstalled () (7 modalit�s) (0)
select AVProductsInstalled, COUNT(*) as nb from DSGP.dbo.train group by AVProductsInstalled order by AVProductsInstalled asc
select AVProductsInstalled, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by AVProductsInstalled

-- (12) AVProductsEnabled () (5 modalit�s) (0)
select AVProductsEnabled, COUNT(*) as nb from DSGP.dbo.train group by AVProductsEnabled order by AVProductsEnabled asc
select AVProductsInstalled, AVProductsEnabled, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by AVProductsInstalled, AVProductsEnabled


-- (13) HasTpm () (Binaire) (0)
select HasTpm, COUNT(*) as nb from DSGP.dbo.train group by HasTpm order by HasTpm asc

-- (14) CountryIdentifier (222 modalit�s)
select CountryIdentifier, COUNT(*) as nb from DSGP.dbo.train group by CountryIdentifier order by CountryIdentifier asc
select CountryIdentifier, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop into #ci from DSGP.dbo.train group by CountryIdentifier

-- (15) CityIdentifier (107 366 modalit�s) (0) (drop)
select CityIdentifier, COUNT(*) as nb from DSGP.dbo.train group by CityIdentifier order by CityIdentifier asc

-- (16) OrganizationIdentifier (49 modalit�s) (0)
select OrganizationIdentifier, COUNT(*) as nb from DSGP.dbo.train group by OrganizationIdentifier order by OrganizationIdentifier asc
select OrganizationIdentifier, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop into #oi from DSGP.dbo.train group by OrganizationIdentifier

-- (17) GeoNameIdentifier (293 modalit�s) (0 faible) (drop)
select GeoNameIdentifier, COUNT(*) as nb from DSGP.dbo.train group by GeoNameIdentifier order by GeoNameIdentifier asc

-- (18) LocaleEnglishNameIdentifier (276 modalit�s) (drop)
select LocaleEnglishNameIdentifier, COUNT(*) as nb from DSGP.dbo.train group by LocaleEnglishNameIdentifier order by LocaleEnglishNameIdentifier asc

-- (19) Platform (4 modalit�s) 
select [Platform], COUNT(*) as nb from DSGP.dbo.train group by [Platform] order by [PLATFORM] asc

-- (20) Processor (3 modalit�s) 
select Processor, COUNT(*) as nb from DSGP.dbo.train group by Processor order by Processor asc

-- (21) OsVer (52 modalit�s d�balanc�) 
select OsVer, COUNT(*) as nb from DSGP.dbo.train group by OsVer order by OsVer asc
select substring(OsVer,1,3) as OsVer, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by substring(OsVer,1,3) order by prop asc

-- (22) OsBuild (76 modalit�s d�balanc�) 
select OsBuild, COUNT(*) as nb from DSGP.dbo.train group by OsBuild order by OsBuild asc
select substring(cast(OsBuild as varchar(max)),1,2) as OsBuild, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by substring(cast(OsBuild as varchar(max)),1,2) order by prop asc

-- (23) OsSuite (14 modalit�s ) 
select OsSuite, COUNT(*) as nb from DSGP.dbo.train group by OsSuite order by OsSuite asc
select substring(cast(OsSuite as varchar(max)),1,2) as OsSuite, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by substring(cast(OsSuite as varchar(max)),1,2) order by prop asc


-- (24) OsPlatformSubRelease (9 modalit�s ) 
select OsPlatformSubRelease, COUNT(*) as nb from DSGP.dbo.train group by OsPlatformSubRelease order by OsPlatformSubRelease asc


-- (25) OsBuildLab (664 modalit�s )  (0)
select OsBuildLab, COUNT(*) as nb from DSGP.dbo.train group by OsBuildLab order by OsBuildLab asc
select OsBuildLab, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop into #obl from DSGP.dbo.train group by OsBuildLab order by prop asc

-- (26) SkuEdition (8 modalit�s )  
select SkuEdition, COUNT(*) as nb from DSGP.dbo.train group by SkuEdition order by SkuEdition asc

-- (27) IsProtected (Binaire )  
select IsProtected, COUNT(*) as nb from DSGP.dbo.train group by IsProtected order by IsProtected asc

-- (28) AutoSampleOptIn (Binaire asym�trique)  
select AutoSampleOptIn, COUNT(*) as nb from DSGP.dbo.train group by AutoSampleOptIn order by AutoSampleOptIn asc

-- (29) PuaMode (3 grandement asym�trique)  (0)
select PuaMode, COUNT(*) as nb from DSGP.dbo.train group by PuaMode order by PuaMode asc
select PuaMode, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by PuaMode order by prop asc

-- (30) SMode (binaire asym�trique)  
select SMode, COUNT(*) as nb from DSGP.dbo.train group by SMode order by SMode asc
select SMode, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by SMode order by prop asc

-- (31) IeVerIdentifier (304 Modalit�s)  (0)
select IeVerIdentifier, COUNT(*) as nb from DSGP.dbo.train group by IeVerIdentifier order by IeVerIdentifier asc
select IeVerIdentifier, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by IeVerIdentifier order by prop asc

-- (32) SmartScreen (15 Modalit�s regroupement � faire)  (0)
select case 
			when SmartScreen in ('&#x01;','&#x02;','&#x03;') then 'Adresse'
			when SmartScreen in ('00000000','0','Off') then 'Off'
			when SmartScreen in ('Prompt','Promt') then 'Prompt'
			when SmartScreen = ' ' then 'Inconnue'
			else SmartScreen
			end as SmartScreen
		 , COUNT(*) as nb from DSGP.dbo.train group by case 
			when SmartScreen in ('&#x01;','&#x02;','&#x03;') then 'Adresse'
			when SmartScreen in ('00000000','0','Off') then 'Off'
			when SmartScreen in ('Prompt','Promt') then 'Prompt'
			when SmartScreen = ' ' then 'Inconnue'
			else SmartScreen
			end  order by SmartScreen asc

-- (33) FireWall (Binaire)  
select FireWall, COUNT(*) as nb from DSGP.dbo.train group by FireWall order by FireWall asc

-- (34) UacLuaenable (10 modalit�s)  (0)
select  UacLuaenable, COUNT(*) as nb from DSGP.dbo.train group by UacLuaenable order by UacLuaenable asc
select UacLuaenable, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by UacLuaenable order by prop asc

-- (35) Census_MDC2FormFactor (13 modalit�s) 
select Census_MDC2FormFactor, COUNT(*) as nb from DSGP.dbo.train group by Census_MDC2FormFactor order by Census_MDC2FormFactor asc
select case 
	when Census_MDC2FormFactor in ('AllInOne','Desktop','Notebook','Convertible','PCOther') then 'PC'
	when Census_MDC2FormFactor not in ('AllInOne','Desktop','Notebook','Convertible','PCOther') then 'TabletServeur'
End as  Census_MDC2FormFactor,
sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by case 
	when Census_MDC2FormFactor in ('AllInOne','Desktop','Notebook','Convertible','PCOther') then 'PC'
	when Census_MDC2FormFactor not in ('AllInOne','Desktop','Notebook','Convertible','PCOther') then 'TabletServeur'
End order by prop asc

-- (36) Census_DeviceFamily (3 modalit�s) 
select Census_DeviceFamily, COUNT(*) as nb from DSGP.dbo.train group by Census_DeviceFamily order by Census_DeviceFamily asc
select Census_DeviceFamily, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by Census_DeviceFamily order by prop asc

-- (37) Census_OEMNameIdentifier (3832 modalit�s) (0)
select Census_OEMNameIdentifier, COUNT(*) as nb from DSGP.dbo.train group by Census_OEMNameIdentifier order by Census_OEMNameIdentifier asc
select Census_OEMNameIdentifier, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop into #c_oNI from DSGP.dbo.train group by Census_OEMNameIdentifier order by prop asc

-- (38) Census_ProcessorCoreCount (45 Continue disc�te) (0)
select Census_ProcessorCoreCount, COUNT(*) as nb from DSGP.dbo.train group by Census_ProcessorCoreCount order by Census_ProcessorCoreCount asc

-- (39) Census_ProcessorManufacturerIdentifier (7 modalit�s) (0)
select Census_ProcessorManufacturerIdentifier, COUNT(*) as nb from DSGP.dbo.train group by Census_ProcessorManufacturerIdentifier order by Census_ProcessorManufacturerIdentifier asc
select Census_ProcessorManufacturerIdentifier, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by Census_ProcessorManufacturerIdentifier order by prop asc

-- (40) Census_ProcessorManufacturerIdentifier (7 modalit�s) (0)
select Census_ProcessorManufacturerIdentifier, COUNT(*) as nb from DSGP.dbo.train group by Census_ProcessorManufacturerIdentifier order by Census_ProcessorManufacturerIdentifier asc

-- (41) Census_ProcessorModelIdentifier (3428 modalit�s) (0)
select Census_ProcessorModelIdentifier, COUNT(*) as nb from DSGP.dbo.train group by Census_ProcessorModelIdentifier order by Census_ProcessorModelIdentifier asc
select Census_ProcessorModelIdentifier, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop into #c_pmi from DSGP.dbo.train group by Census_ProcessorModelIdentifier order by prop asc

-- (42) Census_ProcessorClass (3 modalit�s) (0)
select Census_ProcessorClass, COUNT(*) as nb from DSGP.dbo.train group by Census_ProcessorClass order by Census_ProcessorClass asc

-- (43) Census_PrimaryDiskTotalCapacity (Continues (MB)) (0)
select Census_PrimaryDiskTotalCapacity, COUNT(*) as nb from DSGP.dbo.train group by Census_PrimaryDiskTotalCapacity order by Census_PrimaryDiskTotalCapacity asc
select round(avg(cast(Census_PrimaryDiskTotalCapacity as float)),2) from DSGP.dbo.train where cast(Census_PrimaryDiskTotalCapacity as float) > 0

-- (44) Census_PrimaryDiskTypeName (5 modalit�s � regrouper) (0)
select Census_PrimaryDiskTypeName, COUNT(*) as nb from DSGP.dbo.train group by Census_PrimaryDiskTypeName order by Census_PrimaryDiskTypeName asc
select Census_PrimaryDiskTypeName, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop from DSGP.dbo.train group by Census_PrimaryDiskTypeName order by prop asc

-- (45) Census_systemVolumeTotalCapacity (Continues (MB)) (0)
select Census_systemVolumeTotalCapacity, COUNT(*) as nb from DSGP.dbo.train group by Census_systemVolumeTotalCapacity order by Census_systemVolumeTotalCapacity asc
select round(avg(cast(Census_systemVolumeTotalCapacity as float)),2) from DSGP.dbo.train where cast(Census_systemVolumeTotalCapacity as float) > 0


-- (46) Census_HasOpticalDiskDrive (binaire) 
select Census_HasOpticalDiskDrive, COUNT(*) as nb from DSGP.dbo.train group by Census_HasOpticalDiskDrive order by Census_HasOpticalDiskDrive asc
select Census_HasOpticalDiskDrive, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop from DSGP.dbo.train group by Census_HasOpticalDiskDrive order by prop asc

-- (47) Census_TotalPhysicalRam (Continues (MB)) (0) 
select Census_TotalPhysicalRam, COUNT(*) as nb from DSGP.dbo.train group by Census_TotalPhysicalRam order by Census_TotalPhysicalRam asc
select Census_TotalPhysicalRam, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop from DSGP.dbo.train group by Census_TotalPhysicalRam order by prop asc
select round(avg(cast(Census_TotalPhysicalRam as float)),2) from DSGP.dbo.train where cast(Census_TotalPhysicalRam as float) > 0

-- (48) Census_ChassisTypeName (51 modalit�s) (0) 
select Census_ChassisTypeName, COUNT(*) as nb from DSGP.dbo.train group by Census_ChassisTypeName order by Census_ChassisTypeName asc
select Census_ChassisTypeName, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop from DSGP.dbo.train group by Census_ChassisTypeName order by prop asc

-- (49) Census_InternalPrimaryDiagonalDisplaySizeInInches (Continues (Inches)) (0) (moyenne : 16,68)
select Census_InternalPrimaryDiagonalDisplaySizeInInches, COUNT(*) as nb from DSGP.dbo.train group by Census_InternalPrimaryDiagonalDisplaySizeInInches order by Census_InternalPrimaryDiagonalDisplaySizeInInches asc
select round(avg(cast(Census_InternalPrimaryDiagonalDisplaySizeInInches as float)),2) from DSGP.dbo.train where cast(Census_InternalPrimaryDiagonalDisplaySizeInInches as float) > 0

-- (50) Census_InternalPrimaryDisplayResolutionHorizontal (Continues) (0 et valeur n�gatives) (moyenne : 1547.79)
select Census_InternalPrimaryDisplayResolutionHorizontal, COUNT(*) as nb from DSGP.dbo.train group by Census_InternalPrimaryDisplayResolutionHorizontal order by Census_InternalPrimaryDisplayResolutionHorizontal asc
select round(avg(cast(Census_InternalPrimaryDisplayResolutionHorizontal as float)),2) from DSGP.dbo.train where cast(Census_InternalPrimaryDisplayResolutionHorizontal as float) > 0

-- (51) Census_InternalPrimaryDisplayResolutionVertical (Continues) (0 et valeur n�gatives) (moyenne : 897.61)
select Census_InternalPrimaryDisplayResolutionVertical, COUNT(*) as nb from DSGP.dbo.train group by Census_InternalPrimaryDisplayResolutionVertical order by Census_InternalPrimaryDisplayResolutionVertical asc
select round(avg(cast(Census_InternalPrimaryDisplayResolutionVertical as float)),2) from DSGP.dbo.train where cast(Census_InternalPrimaryDisplayResolutionVertical as float) > 0

-- (52) Census_PowerPlatformRoleName (11 modalit�s) (0) 
select case 
when Census_PowerPlatformRoleName in (' ','Unspecified','UNKNOWN') then 'Inconnu' 
else Census_PowerPlatformRoleName end as Census_PowerPlatformRoleName , COUNT(*) as nb from DSGP.dbo.train group by case 
when Census_PowerPlatformRoleName in (' ','Unspecified','UNKNOWN') then 'Inconnu' else Census_PowerPlatformRoleName end order by Census_PowerPlatformRoleName asc

-- (53) Census_InternalBatteryType (80 modalit�s) (0) 
select Census_InternalBatteryType, COUNT(*) as nb from DSGP.dbo.train group by Census_InternalBatteryType order by Census_InternalBatteryType asc

-- (54) Census_InternalBatteryNumberOfCharges (Disc�tes log scale ?) (0) => Renseigne sur l'ancienet� de l'ordinateur.
select log(Census_InternalBatteryNumberOfCharges+1) as Census_InternalBatteryNumberOfCharges, COUNT(*) as nb from DSGP.dbo.train group by log(Census_InternalBatteryNumberOfCharges+1) order by Census_InternalBatteryNumberOfCharges asc

-- (55) Census_OSVersion (469 modalit�s)  
select Census_OSVersion, COUNT(*) as nb from DSGP.dbo.train group by Census_OSVersion order by Census_OSVersion asc
select substring(Census_OSVersion,1,6) as Census_OSVersion, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by substring(Census_OSVersion,1,6) order by prop asc

-- (56) Census_OSArchitecture (3 modalit�s)  
select Census_OSArchitecture, COUNT(*) as nb from DSGP.dbo.train group by Census_OSArchitecture order by Census_OSArchitecture asc

-- (57) Census_OSBranch (32 modalit�s)  
select Census_OSBranch, COUNT(*) as nb from DSGP.dbo.train group by Census_OSBranch order by Census_OSBranch asc

-- (58) Census_OSBuildNumber (165 modalit�s)  
select Census_OSBuildNumber, COUNT(*) as nb from DSGP.dbo.train group by Census_OSBuildNumber order by Census_OSBuildNumber asc

-- (59) Census_OSBuildRevision (285 modalit�s)  
select Census_OSBuildRevision, COUNT(*) as nb from DSGP.dbo.train group by Census_OSBuildRevision order by Census_OSBuildRevision asc

-- (60) Census_OSEdition (30 modalit�s)  
select Census_OSEdition, COUNT(*) as nb from DSGP.dbo.train group by Census_OSEdition order by Census_OSEdition asc
select substring(Census_OSEdition,1,3) as Census_OSEdition, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by substring(Census_OSEdition,1,3) order by prop asc

-- (61) Census_OSSkuName (30 modalit�s)   (OSEdition et OSSkuName sont les m�mes)
select Census_OSSkuName, COUNT(*) as nb from DSGP.dbo.train group by Census_OSSkuName order by Census_OSSkuName asc

-- (62) Census_OSInstallTypeName (9 modalit�s) =>
select 
	case 
		when Census_OSInstallTypeName in ('Clean','CleanPCRefresh','IBSClean') then 'Clean' 
		when Census_OSInstallTypeName in ('Update','Upgrade', 'UUPUpgrade') then 'Update'
		else Census_OSInstallTypeName
		end aS Census_OSInstallTypeName
		, COUNT(*) as nb from DSGP.dbo.train group by case when Census_OSInstallTypeName in ('Clean','CleanPCRefresh','IBSClean') then 'Clean' 
		when Census_OSInstallTypeName in ('Update','Upgrade', 'UUPUpgrade') then 'Update'
		else Census_OSInstallTypeName
		end order by Census_OSInstallTypeName asc

-- (63) Census_OSInstallLanguageIdentifier  (40 modalit�s) =>
select Census_OSInstallLanguageIdentifier, COUNT(*) as nb from DSGP.dbo.train group by Census_OSInstallLanguageIdentifier order by Census_OSInstallLanguageIdentifier asc
select Census_OSInstallLanguageIdentifier, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop into #C_oili from DSGP.dbo.train group by Census_OSInstallLanguageIdentifier order by prop asc

-- (64) Census_OSUILocaleIdentifier  (147 modalit�s) =>
select Census_OSUILocaleIdentifier, COUNT(*) as nb from DSGP.dbo.train group by Census_OSUILocaleIdentifier order by Census_OSUILocaleIdentifier asc
select Census_OSUILocaleIdentifier, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by Census_OSUILocaleIdentifier order by prop asc

-- (65) Census_OSWUAutoUpdateOptionsName  (6 modalit�s) => (Unknown)
select Census_OSWUAutoUpdateOptionsName, COUNT(*) as nb from DSGP.dbo.train group by Census_OSWUAutoUpdateOptionsName order by Census_OSWUAutoUpdateOptionsName asc

-- (66) Census_IsPortableOperatingSystem  (Binaire) (5000 � garder ?)
select Census_IsPortableOperatingSystem, COUNT(*) as nb from DSGP.dbo.train group by Census_IsPortableOperatingSystem order by Census_IsPortableOperatingSystem asc

-- (67) Census_GenuineStateName  (5 modalit�s) => (Unknown) et 2 dans tempered
select Census_GenuineStateName, COUNT(*) as nb from DSGP.dbo.train group by Census_GenuineStateName order by Census_GenuineStateName asc
select case when Census_GenuineStateName = 'TAMPERED' then 'UNKNOWN' else Census_GenuineStateName end as Census_GenuineStateName, COUNT(*) as nb from DSGP.dbo.train group by case when Census_GenuineStateName = 'TAMPERED' then 'UNKNOWN' else Census_GenuineStateName end order by Census_GenuineStateName asc

-- (68) Census_ActivationChannel (6 modalit�s) => (Unknown) 
select Census_ActivationChannel, COUNT(*) as nb from DSGP.dbo.train group by Census_ActivationChannel order by Census_ActivationChannel asc

-- (69) Census_IsFlightingInternal (Binaire) d�balanc� (hautement) (drop)
select Census_IsFlightingInternal, COUNT(*) as nb from DSGP.dbo.train group by Census_IsFlightingInternal order by Census_IsFlightingInternal asc

-- (70) Census_IsFlightsDisabled (Binaire) D�balanc� (hautement) (drop)
select Census_IsFlightsDisabled, COUNT(*) as nb from DSGP.dbo.train group by Census_IsFlightsDisabled order by Census_IsFlightsDisabled asc

-- (71) Census_FlightRing (10 modalit�s) => Unknown (drop) (trop d�balanc�)
select Census_FlightRing, COUNT(*) as nb from DSGP.dbo.train group by Census_FlightRing order by Census_FlightRing asc

-- (72) Census_ThresholdOptIn (binaire) => d�balanc� (hautement) (drop)
select Census_ThresholdOptIn, COUNT(*) as nb from DSGP.dbo.train group by Census_ThresholdOptIn order by Census_ThresholdOptIn asc

-- (73) Census_FirmwareManufacturerIdentifier (713 modalit�s) (drop)
select Census_FirmwareManufacturerIdentifier, COUNT(*) as nb from DSGP.dbo.train group by Census_FirmwareManufacturerIdentifier order by Census_FirmwareManufacturerIdentifier asc
select Census_FirmwareManufacturerIdentifier, sum(HasDetections) as Nb ,COUNT(*) as nbtot, round(cast( sum(HasDetections) as float)/cast(COUNT(*) as float),2) as prop  from DSGP.dbo.train group by Census_FirmwareManufacturerIdentifier order by prop asc

-- (74) Census_FirmwareVersionIdentifier (50 495 modalit�s) (drop)
select Census_FirmwareVersionIdentifier, COUNT(*) as nb from DSGP.dbo.train group by Census_FirmwareVersionIdentifier order by Census_FirmwareVersionIdentifier asc

-- (75) Census_IsSecureBootEnabled (Binaire) (ok)
select Census_IsSecureBootEnabled, COUNT(*) as nb from DSGP.dbo.train group by Census_IsSecureBootEnabled order by Census_IsSecureBootEnabled asc

-- (76) Census_IsWIMBootEnabled (Binaire) (d�balanc� hautement) (drop)
select Census_IsWIMBootEnabled, COUNT(*) as nb from DSGP.dbo.train group by Census_IsWIMBootEnabled order by Census_IsWIMBootEnabled asc

-- (77) Census_IsVirtualDevice (Binaire) (garde)
select Census_IsVirtualDevice, COUNT(*) as nb from DSGP.dbo.train group by Census_IsVirtualDevice order by Census_IsVirtualDevice asc

-- (78) Census_IsTouchEnabled (Binaire) (garde)
select Census_IsTouchEnabled, COUNT(*) as nb from DSGP.dbo.train group by Census_IsTouchEnabled order by Census_IsTouchEnabled asc

-- (79) Census_IsPenCapable (Binaire) (drop d�balanc�)
select Census_IsPenCapable, COUNT(*) as nb from DSGP.dbo.train group by Census_IsPenCapable order by Census_IsPenCapable asc

-- (80) Census_IsAlwaysOnAlwaysConnectedCapable (Binaire) (garde) (5% des donn�es � 1)
select Census_IsAlwaysOnAlwaysConnectedCapable, COUNT(*) as nb from DSGP.dbo.train group by Census_IsAlwaysOnAlwaysConnectedCapable order by Census_IsAlwaysOnAlwaysConnectedCapable asc
-- (81) Wdft_IsGamer (Binaire) (garde)
select Wdft_IsGamer, COUNT(*) as nb from DSGP.dbo.train group by Wdft_IsGamer order by Wdft_IsGamer asc

-- (82) Wdft_RegionIdentifier (15 modalit�s) => 0
select Wdft_RegionIdentifier, COUNT(*) as nb from DSGP.dbo.train group by Wdft_RegionIdentifier order by Wdft_RegionIdentifier asc
-- (83) HasDetections (Binaire (R�ponse)) => 0
select HasDetections, COUNT(*) as nb from DSGP.dbo.train group by HasDetections order by HasDetections asc
